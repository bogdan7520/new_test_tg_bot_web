<!doctype html>
<html lang="ua">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <title>Оформити заказ</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;700');
        .symbols {
          font-family: 'Material Symbols Outlined';
          font-variation-settings:
          'FILL' 0,
          'wght' 400,
          'GRAD' 0,
          'opsz' 48
        }
        * {
          margin: 0;
          padding: 0;
          font-family: 'Montserrat', sans-serif;
        }
        body {
          display: flex;
          justify-content: center;
          align-items: center;
          height: 100vh;
          background: var(--tg-theme-bg-color);
          color: var(--tg-theme-text-color);
        }
        .form {
          background: #8ba1c6;
          border-radius: 3px;
          padding: 20px;
          color: #333;
          display: flex;
          flex-direction: column-reverse;
          box-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
          position: relative;
        }
        .form .input {
          padding: 10px 20px;
          outline: none;
          font-size: 20px;
          background: #dae6ff;
          border-radius: 3px;
          border: 2px solid #8ba1c6;
          box-shadow: 0 0 5px rgba(255, 255, 255, 0.05);
          color: #333;
          z-index: 10;
          margin-top: 20px;
          font-weight: bold;
        }
        .form .input + .label {
          margin-bottom: -55px;
          margin-top: 45px;
          margin-left: 20px;
          font-size: 20px;
          user-select: none;
          cursor: text;
          color: #333;
          transition: all 0.3s ease;
          z-index: 11;
        }
        .form .input:focus + .label,
        .form .input:valid + .label {
          margin-bottom: -18px;
          margin-left: 10px;
          margin-top: 20;
          font-size: 16px;
          color: #fff;
        }

        .btn {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border-radius: 3px;
            border: 0;
            font-weight: bold;
            padding: 10px 20px;
            margin-top: 20px;
            cursor: pointer;
            font-size: 20px;
        }
        .btn:hover {
            background: var(--tg-theme-secondary-bg-color);
        }

        .form .checkbox {
          display: none;
          margin-top: 20px;
        }
        .form .checkbox + .label {
          position: relative;
          display: block;
          height: 25px;
          width: 70px;
          border-radius: 100px;
          background: #c9c9c9;
          cursor: pointer;
          margin-top: 20px;
        }
        .form .checkbox + .label .round {
          position: relative;
          height: 30px;
          width: 40px;
          background: #9c4147;
          border-radius: 50px;
          top: -2.5px;
          left: -2.5px;
          box-shadow: inset -2px -2px 5px rgba(51, 51, 51, 0.2),
          inset 2px 2px 5px rgba(255, 255, 255, 0.3),
          0px 0px 5px rgba(51, 51, 51, 0.3);
          transition: all 0.3s ease;
        }
        .form .checkbox:checked + .label .round {
          transform: translateX(100%);
          background: #428048;
        }
        .form .checkbox + .label .text {
          position: absolute;
          top: 3px;
          left: 90px;
          user-select: none;
          transition: all 0.3s ease;
          width: 190px;
          color: #fff;
        }
        .form .checkbox:checked + .label .round::after {
          content: "ua";
        }
        .form .checkbox + .label .round::after {
          content: "ru";
          display: inline-block;
          position: absolute;
          top: calc(50% - 10px);
          left: calc(50% - 10px);
          font-weight: bold;
          color: white;
        }

        #select_id {
            margin-top: 5px;
            padding: 10px 20px;
            background: #dae6ff;
            border: none;
            border-radius: 5px;
            color: #333;
            font-weight: bold;
        }
        #select_id option {
            font-weight: bold;
        }
        #select_id + .label {
            margin-top: 25px;
            color: #fff;
        }
        .btn:disabled {
            cursor: no-drop;
            color: #ccc;
        }
  </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <form action="" class="form">
    <button class="btn" id="btn" type="button" disabled>Оформити</button>

    <input type="checkbox" class="checkbox" id="checkbox" checked>
    <label for="checkbox" class="label">
      <div class="round"></div>
      <span class="text">На якій мові вишивати</span>
    </label>

    <input type="number" class="input" id="input5" required>
    <label for="input5" class="label">Ваш телефон з viber <b style="color: red;">*</b></label>

    <input type="text" class="input" id="input3" required>
    <label for="input3" class="label">Поясненя до вашого заказу</label>

    <input type="text" class="input" id="input2" required>
    <label for="input2" class="label">Ще текст</label>

    <select name="" id="select_id">
        <option value="none">Нічого</option>
        <option value="tah">Таінство Хрещення - 80грн</option>
        <option value="slim">З любов'ю від хрещеної матері - 130грн</option>
        <option value="slm">З любов'ю від хрестної матері - 130грн</option>
        <option value="slit">З любов'ю від хрещеного батька - 130грн</option>
        <option value="slt">З любов'ю від хрестного батька - 130грн</option>
        <option value="sliti">З любов'ю від хрещених батьків - 140грн</option>
        <option value="slti">З любов'ю від хрестних батьків - 140грн</option>
        <option value="nehay">Нехай Господь тебе оберігає - 150грн</option>
    </select>
    <label for="select_id" class="label">Текст</label>

    <input type="text" class="input" id="input4" required>
    <label for="input4" class="label">Дата, яку вишивати</label>

    <input type="text" class="input" id="input" required>
    <label for="input" class="label">Ім'я, яке вишивати</label>

    <h2>Оформити заказ</h2>
  </form>
    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        let btn = document.querySelector("#btn");
        let input = document.querySelector("#input");
        let input2 = document.querySelector("#input2");
        let input3 = document.querySelector("#input3");
        let input4 = document.querySelector("#input4");
        let input5 = document.querySelector("#input5");
        let label = document.querySelector("#input + .label");
        let label2 = document.querySelector("#input2 + .label");
        let label3 = document.querySelector("#input3 + .label");
        let label4 = document.querySelector("#input4 + .label");
        let select = document.querySelector("#select_id");
        let checkbox = document.querySelector("#checkbox");

        reload_price_name();
        reload_price_date();
        reload_price_text();
        select_change();
        reload_phone();

        select.onchange = function () {
          select_change();
        }

        input.oninput = function () {
            reload_price_name();
        }

        input4.oninput = function () {
            reload_price_date();
        }

        input2.oninput = function () {
            reload_price_text();
        }
        input5.oninput = function () {
            reload_phone();
        }

        btn.addEventListener("click", () => {
            let order = "";
            let price_vishivka = 0;
            if (input.value.length > 0) {
                order += "Ім'я: " + input.value + label.innerHTML.replace("Ім'я, яке вишивати\nЦіна - ", " ") + "\n";
                price_vishivka += Number(label.innerHTML.replace("Ім'я, яке вишивати\nЦіна - ", "").replace("грн", ""));
            }
            if (input4.value.length > 0) {
                order += "Дата: " + input4.value + label4.innerHTML.replace("Дата, яку вишивати\nЦіна - ", " ") + "\n";
                price_vishivka += Number(label4.innerHTML.replace("Дата, яку вишивати\nЦіна - ", "").replace("грн", ""));
            }
            if (select.selectedIndex != 0) {
                order += "Текст: " + select.options[select.selectedIndex].text + "\n";
                price_vishivka += Number(select.options[select.selectedIndex].text.split(" ").pop().replace("грн", ""));
            }
            if (input2.value.length > 0) {
                order += "Ще текст: " + input2.value + label2.innerHTML.replace("Ще текст", "").replace("\nЦіна - ", " ") + "\n";
                if (Number.isInteger(Number(label2.innerHTML.replace("Ще текст\nЦіна - ", "").replace("грн", "")))) {
                    price_vishivka += Number(label2.innerHTML.replace("Ще текст\nЦіна - ", "").replace("грн", ""));
                } else {
                    price_vishivka = "Про вартість вишивки відпишемося вам на viber";
                }
            }
            if (input3.value.length > 0) {
                order += "Поясненя до вашого заказу: " + input3.value;
            }
            let language = "ua";
            if (!checkbox.checked) {
                language = "ru";
            }
            let data = {
                name: input.value,
                date: input4.value,
                text_from: select.options[select.selectedIndex].text.split(" ").slice(0, -2).join(" "),
                text: input2.value,
                about: input3.value,
                order: order,
                price_vishivka: price_vishivka,
                language: language,
                number: input5.value
            }
            tg.sendData(JSON.stringify(data));
            tg.close();
        })
        function reload_price_name() {
            let price = "";
            if (input.value.length == 0) {
                price = "";
            } else if (input.value.length <= 3) {
                price = "\nЦіна - 80грн";
            } else if (input.value.length > 3) {
                price = "\nЦіна - 100грн";
            }
            label.innerHTML = "Ім'я, яке вишивати" + price
        }
        function reload_price_date() {
            let price = "";
            if (input4.value.length == 0) {
                price = "";
            } else {
                price = "\nЦіна - 40грн";
            }
            label4.innerHTML = "Дата, яку вишивати" + price
        }
        function reload_price_text() {
            let price = "";
            if (input2.value.length == 0) {
                price = "";
            } else if (input2.value.toLowerCase() == "таїнство хрещеня" || input2.value.toLowerCase() == "таинство крещения") {
                price = "\nЦіна - 80грн";
            } else if (input2.value.toLowerCase().includes("з любов'ю від крещеной мами") || input2.value.toLowerCase().includes("с любовъю от крестной мамы")) {
                price = "\nЦіна - 130грн";
            } else if (input2.value.toLowerCase().includes("з любов'ю від крещених батьків") || input2.value.toLowerCase().includes("с любовъю от крестных родителей")) {
                price = "\nЦіна - 140грн";
            } else if (input2.value.toLowerCase().includes("з любов'ю від крещеного батька") || input2.value.toLowerCase().includes("с любовъю от крёстного отца")) {
                price = "\nЦіна - 130грн";
            } else if (input2.value.toLowerCase().includes("Нехай Господь тебе оберігає".toLowerCase()) || input2.value.toLowerCase().includes("Пусть Господь тебя оберигает".toLowerCase())) {
                price = "\nЦіна - 150грн";
            }
            label2.innerHTML = "Ще текст" + price
        }
        function select_change() {
            let selected_index = select.selectedIndex;
            let options = select.options;

        }
        function reload_phone() {
            if ((input5.value.split("")[0] != 0 && input5.value.length == 9) || (input5.value.split("")[0] == 0 && input5.value.length == 10)) {
                btn.removeAttribute("disabled");
            } else {
                btn.setAttribute("disabled", "disabled");
            }
        }
    </script>
</body>
</html>
